; RUN: %generalize -souper-debug-level=2 %s > /dev/null 2>%t
; RUN: %FileCheck %s < %t

%v0:i32 = var ; v0
%1:i32 = add 4:i32, %v0
%2:i32 = shl %1, 2:i32
%3:i32 = sub %2, 16:i32
infer %3
%4:i32 = shl %v0, 2:i32
result %4

; CHECK: C[[#X:]] == (C[[#Y:]] << C[[#Z:]])
; CHECK:   |=
; CHECK: ((v0 + C[[#Y]]) << C[[#Z]]) - C[[#X]]
; CHECK:   =>
; CHECK: v0 << C[[#Z]]
